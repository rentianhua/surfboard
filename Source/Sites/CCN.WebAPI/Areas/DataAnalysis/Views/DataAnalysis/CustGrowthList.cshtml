
@{
    Layout = "~/Views/Shared/_LayoutEmpty.cshtml";
}

<script type="text/javascript">

    $(function () {
        var myDate = new Date();

        var year = myDate.getFullYear();
        var month = myDate.getMonth() + 1;
        var day = myDate.getDate();
        var start = year + "-" + month + "-" + "01";
        $("#starttime").val(start);
        $("#endtime").val(year + "-" + month + "-" + day);

        QueryList();
        InitTotal();
    });

    //获取总数
    function InitTotal() {
        $.get("/api/DataAnalysis/GetTotal", function (data) {
            var obj = data.errmsg;
            $("#custtotal").html(obj.value);
            $("#fanstotal").html(obj.value2);
            $("#cartotal").html(obj.value4);
        });
    }

    //获取列表数据
    function QueryList() {
        var json = {
            starttime: $("#starttime").val(),
            endtime: $("#endtime").val()
        };

        $.post("/api/DataAnalysis/GetDayGrowth", json, function (data) {
            $("#anaiysislist tbody").empty();
            var str = "";
            $.each(data.errmsg, function (key, val) {
                var myDate = new Date(val.key);
                console.log();

                str = "";
                str += "<tr>";
                str += "<td>" + (key + 1) + "</td>";
                str += "<td>" + Dateformat(val.key, "yyyy-MM-dd") + "</td>";
                str += "<td>" + val.value + "</td>";
                str += "<td>" + val.value4 + "</td>";
                str += "<td>" + val.value2 + "</td>";
                str += "</tr>";
                $("#anaiysislist tbody").append(str);
            });
        });
    }
</script>

<div>
    <div style="font-size: 18px; font-weight: bold; text-align: center; line-height: 20px;">会员/车辆增长列表</div>
    <table style="margin: 0 auto;">
        <tr>
            <td>
                开始时间：
                <input id="starttime" class="Wdate" type="text" placeholder="开始时间" onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd' })">
            </td>
            <td>
                结束时间：
                <input id="endtime" class="Wdate" type="text" placeholder="结束时间" onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd' })"><input type="button" value="搜索" onclick="QueryList();" />
            </td>
        </tr>
        <tr>

            <td colspan="3">
                <table class="gridtable" style="min-width: 580px; margin-top: 20px;">
                    <tr>
                        <td style="font-weight: bold; background-color: #ccc; font-size: 14px;"  colspan="3">
                            汇总信息
                        </td>
                    </tr>
                    <tr>
                        <td>
                            会员总数：
                            <span id="custtotal" style="color: red">0</span>
                            @*<input id="custtotal" type="text" placeholder="会员总数" >*@
                        </td>
                        <td>
                            粉丝总数：
                            <span id="fanstotal" style="color: red">0</span>
                            @*<input id="fanstotal" type="text" placeholder="粉丝总数" >*@
                        </td>
                        <td>
                            车辆总数：
                            <span id="cartotal" style="color: red">0</span>
                            @*<input id="cartotal" type="text" placeholder="车辆总数" >*@
                        </td>
                    </tr>
                </table>
            </td>

        </tr>
        <tr>
            <td colspan="3">
                
                <table id="anaiysislist" class="gridtable" style="min-width: 580px;margin-top: 20px;">

                    <thead>
                        <tr>
                            <td style="font-weight: bold; background-color: #ccc; font-size: 14px;" colspan="5">
                                明细信息
                            </td>
                        </tr>
                    <tr>
                        <td>序号</td>
                        <td>日期</td>
                        <td>会员增长数</td>
                        <td>粉丝增长数</td>
                        <td>车辆增长数</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </td>
        </tr>
    </table>
</div>

